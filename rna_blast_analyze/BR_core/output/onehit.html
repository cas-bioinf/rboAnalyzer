{% extends "base.html" %}
{% block header %}
<p>pipeline output for {{hea.input}}</p>
{% endblock %}
{% block content %}
    {% macro create_onehit(data) %}
    <div class="onehit" data-brna_sequence="{{data.sequence}}" data-brna_seqname="{{data.seqname}}"
         data-eval="{{data.eval}}">
        <h3 class="onehit_heading" style="background:{{data.h_color}};">
            Hit: {{data.source_seq_name}}
        </h3>
        <div class="onehit_body">
            <div class="row reports">
                <div class="blast_text repitem">
                    <p class="header-bhname">{{data.blast_hit_name}}</p>
                    <pre>
{{data.blast_text}}</pre>
                </div>
                <div class="repitem">
                    <p><u>Extension report:</u></p>
                    <table>
                        <tr>
                            <th class="left" scope="row">sequence start:</th>
                            <td class="right">{{data.ext_start}}</td>
                        </tr>
                        <tr>
                            <th class="left" scope="row">sequence end:</th>
                            <td class="right">{{data.ext_end}}</td>
                        </tr>
                        <tr>
                            <th class="left" scope="row">RSEARCH bits score:</th>
                            <td class="right">{{data.rsearchbitscore}}</td>
                        </tr>
                        <tr>
                            <th class="left" scope="row">Homology estimate:</th>
                            <td class="rigth">{{data.h_estimate}}</td>
                        </tr>
                    </table>
                </div>
                <div class="repitem">
                    <div>
                        <label for="indivSequenceCheckbox"><u>Extended sequence fasta:</u></label>
                        <input type="checkbox" class="individualSequenceCheckbox" id="indivSequenceCheckbox">
                    </div>
                    <textarea readonly="true" rows="5" cols="65">{{data.formated_seq}}</textarea>
                </div>
                <!--</div>-->
            </div>
        <div class="row">
            {% for pic in data.pictures %}
                <figure class="column" data-brna_secondary_structure="{{pic.secondary_structure}}">
                    <a href onclick="mypicload(this)">
                        <img class="rnapic" src="{{pic.pic}}" />
                    </a>
                    <figcaption>
                        {{pic.picname}}
                        <input type="checkbox" class="individualStructureCheckbox">
                    </figcaption>
                </figure>
            {% endfor %}
        </div>

        {% if data.draw_seqview %}

            <div id="sv{{data.intid}}" data-sv_params="{{data.seqviewurl}}" class="sv">
                <button class= "seqviewbtn" onclick="viewRegion(this)" title="View selected Regions">Load Sequence viewer</button>
            </div>

        {% endif %}
        </div>
    </div>
    {% endmacro %}

{% for ii in input_list %}
    {{ create_onehit(ii) }}
{% endfor %}
{% endblock %}

{% block footer %}
<h3 class="onehit_heading">
    command and parameters
</h3>
<div class="footerwrap">
    <p class="header-command"><u>executed command:</u></p>
    <textarea readonly="true" rows="3" cols="65">{{foo.command}}</textarea>
    <p>
        <u>date:</u>
        {% if foo.exec_date %}
            {{strftime("%H:%M:%S %d. %m. %Y", foo.exec_date)}}
        {% else %}
            Unknown date.
        {% endif %}
    </p>
    <pre><u>parameters:</u>
{% for par in foo.parameters %}
    <u>{{par[0]}}:</u> {{par[1]}}
{% endfor %}
    </pre>
</div>
<div class="bottom-space"></div>
{% endblock %}